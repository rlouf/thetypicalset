<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-08-24 Wed 20:25 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>La pyramide des votants</title>
<meta name="author" content="Rémi Louf" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="style.css" /><script data-goatcounter="https://thetypicalset.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">La pyramide des votants</h1>
<div class="org-src-container">
<pre class="src src-elisp">(pyvenv-workon 'pyramide)
</pre>
</div>

<p>
L'idée est de reprendre la pyramide des âges et la moduler par:
</p>

<ul class="org-ul">
<li>Le % d'abstention par classe d'âge</li>
<li>Le % de vote LREM</li>
<li>Le % de vote Gauche</li>
<li>Le % de vote droite</li>
</ul>

<p>
Et en faire une jolie visualization.
</p>

<div class="org-src-container">
<pre class="src src-python" id="org32278e2"><span style="font-style: italic;">"""</span>
<span style="font-style: italic;">These data were downloaded from https://www.insee.fr/fr/statistiques/2381472#tableau-figure1</span>
<span style="font-style: italic;">Key = age r&#233;volu (100 = 100 ans et plus)</span>
<span style="font-style: italic;">Value = nombre de personnes dans la population fran&#231;aise</span>
<span style="font-style: italic;">"""</span>
<span style="font-weight: bold; font-style: italic;">population</span> = {
    0: 690942,
    1: 695063,
    2: 716123,
    3: 725576,
    4: 743039,
    5: 762367,
    6: 783332,
    7: 810097,
    8: 817631,
    9: 835242,
    10: 840895,
    11: 862319,
    12: 853243,
    13: 859175,
    14: 854278,
    15: 867238,
    16: 849665,
    17: 841314,
    18: 831528,
    19: 827807,
    20: 830697,
    21: 835200,
    22: 778873,
    23: 765236,
    24: 741535,
    25: 746399,
    26: 738131,
    27: 722662,
    28: 728320,
    29: 764166,
    30: 779572,
    31: 801165,
    32: 806948,
    33: 821127,
    34: 824250,
    35: 839830,
    36: 838306,
    37: 834328,
    38: 820145,
    39: 868806,
    40: 874869,
    41: 886274,
    42: 837272,
    43: 818115,
    44: 820176,
    45: 799456,
    46: 824241,
    47: 866161,
    48: 907462,
    49: 927759,
    50: 921723,
    51: 900060,
    52: 888235,
    53: 875245,
    54: 871895,
    55: 890989,
    56: 891608,
    57: 899644,
    58: 887307,
    59: 856255,
    60: 853667,
    61: 846060,
    62: 839655,
    63: 816587,
    64: 809514,
    65: 800032,
    66: 787325,
    67: 779454,
    68: 760616,
    69: 768507,
    70: 743139,
    71: 764252,
    72: 744985,
    73: 736777,
    74: 715221,
    75: 666821,
    76: 498019,
    77: 478997,
    78: 459971,
    79: 418516,
    80: 365621,
    81: 371202,
    82: 379585,
    83: 357369,
    84: 337938,
    85: 322009,
    86: 294853,
    87: 278596,
    88: 246130,
    89: 229535,
    90: 197481,
    91: 172622,
    92: 135469,
    93: 111515,
    94: 88537,
    95: 69657,
    96: 53102,
    97: 38627,
    98: 27946,
    99: 19134,
    100: 31037,
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="orge5f6733"><span style="font-weight: bold; font-style: italic;">ages_limite</span> = [24, 34, 49, 59, 69, 101]
<span style="font-weight: bold; font-style: italic;">participation</span> = [.65, .66, .75, .78, .85, .89]
<span style="font-weight: bold; font-style: italic;">intentions</span> = {
    <span style="font-style: italic;">"M&#233;lenchon"</span>: [.13, .12, .10, .09, .07, .03],
    <span style="font-style: italic;">"Jadot"</span>: [.12, .09, .08, .06, .06, .04],
    <span style="font-style: italic;">"Macron"</span>: [.18, .19, .23, .22, .28, .33],
    <span style="font-style: italic;">"P&#233;cresse"</span>: [.08, .09, .10, .13, .15, .28],
    <span style="font-style: italic;">"Le Pen"</span>: [.16, .19, .20, .20, .13, .08],
    <span style="font-style: italic;">"Zemmour"</span>: [.12, .14, .11, .14, .14, .13],
}

<span style="font-weight: bold; font-style: italic;">colors</span> = {
    <span style="font-style: italic;">"M&#233;lenchon"</span>: <span style="font-style: italic;">"#E85D75"</span>,
    <span style="font-style: italic;">"Jadot"</span>: <span style="font-style: italic;">"#B2C9AB"</span>,
    <span style="font-style: italic;">"Macron"</span>: <span style="font-style: italic;">"#748CAB"</span>,
    <span style="font-style: italic;">"P&#233;cresse"</span>: <span style="font-style: italic;">"#748CAB"</span>,
    <span style="font-style: italic;">"Zemmour"</span>: <span style="font-style: italic;">"#080708"</span>,
    <span style="font-style: italic;">"Le Pen"</span>: <span style="font-style: italic;">"#292F36"</span>,
}
</pre>
</div>


<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">import</span> bisect
<span style="font-weight: bold;">import</span> numpy <span style="font-weight: bold;">as</span> np

<span style="font-weight: bold; font-style: italic;">ages</span> = <span style="font-weight: bold;">list</span>(population.keys())[18:]

<span style="font-weight: bold;">def</span> <span style="font-weight: bold;">get_num_votes</span>(population, ages_limite, intentions):
    <span style="font-weight: bold; font-style: italic;">num_votes</span> = []
    <span style="font-weight: bold;">for</span> a <span style="font-weight: bold;">in</span> ages:
        <span style="font-weight: bold; font-style: italic;">idx</span> = bisect.bisect_left(ages_limite, a)
        num_votes.append(<span style="font-weight: bold;">int</span>(population[a] * participation[idx] * intentions[idx]))
    <span style="font-weight: bold;">return</span> num_votes

<span style="font-weight: bold; font-style: italic;">participants</span> = get_num_votes(population, ages_limite, participation)
<span style="font-weight: bold; font-style: italic;">votes</span> = {name: get_num_votes(population, ages_limite, values) <span style="font-weight: bold;">for</span> name, values <span style="font-weight: bold;">in</span>  intentions.items()}
<span style="font-weight: bold; font-style: italic;">idx_median</span> = {name: bisect.bisect_left(np.cumsum(values) / np.<span style="font-weight: bold;">sum</span>(values), 0.5) <span style="font-weight: bold;">for</span> name, values <span style="font-weight: bold;">in</span> votes.items()}
<span style="font-weight: bold; font-style: italic;">median</span> = {name: ages[idx] <span style="font-weight: bold;">for</span> name, idx <span style="font-weight: bold;">in</span> idx_median.items()}
<span style="font-weight: bold; font-style: italic;">mean</span> = {name: <span style="font-weight: bold;">int</span>(np.<span style="font-weight: bold;">sum</span>(np.array(ages) * values)/np.<span style="font-weight: bold;">sum</span>(values)) <span style="font-weight: bold;">for</span> name, values <span style="font-weight: bold;">in</span> votes.items()}
</pre>
</div>


<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">import</span> matplotlib.pyplot <span style="font-weight: bold;">as</span> plt
<span style="font-weight: bold;">import</span> matplotlib.gridspec <span style="font-weight: bold;">as</span> gridspec

<span style="font-weight: bold;">def</span> <span style="font-weight: bold;">add_title</span>(ax, name, legend=<span style="font-style: italic;">""</span>):
    ax.text(
        0.5,
        1.1,
        f<span style="font-style: italic;">"{name}"</span>,
        ha=<span style="font-style: italic;">"center"</span>,
        va=<span style="font-style: italic;">"bottom"</span>,
        fontname=<span style="font-style: italic;">"Futura PT"</span>,
        fontsize=25,
        fontweight=<span style="font-style: italic;">"bold"</span>,
    )
    ax.text(
        0.5,
        0.95,
        <span style="font-style: italic;">"Ce grqphique repr&#233;sente la distibution des &#226;ges des gens qui"</span>,
        ha=<span style="font-style: italic;">"center"</span>,
        va=<span style="font-style: italic;">"bottom"</span>,
        fontname=<span style="font-style: italic;">"Futura PT"</span>,
        fontsize=10,
    )
    ax.axis(<span style="font-style: italic;">"off"</span>)

<span style="font-weight: bold;">def</span> <span style="font-weight: bold;">add_pyramide</span>(ax, ages, num_votes, median_idx, color=<span style="font-style: italic;">"blue"</span>):
    ax.bar(
        ages,
        num_votes/np.<span style="font-weight: bold;">sum</span>(num_votes),
        width=1.0,
        align=<span style="font-style: italic;">"edge"</span>,
        color=[color <span style="font-weight: bold;">for</span> _ <span style="font-weight: bold;">in</span> <span style="font-weight: bold;">range</span>(median_idx)] + [<span style="font-style: italic;">"black"</span>] + [color <span style="font-weight: bold;">for</span> _ <span style="font-weight: bold;">in</span> <span style="font-weight: bold;">range</span>(<span style="font-weight: bold;">len</span>(ages)-median_idx-1)],
        ec=<span style="font-style: italic;">"white"</span>,
    )
    <span style="font-weight: bold; font-style: italic;">#</span><span style="font-weight: bold; font-style: italic;">ax.invert_yaxis()</span>
    ax.spines[<span style="font-style: italic;">"left"</span>].set_visible(<span style="font-weight: bold; text-decoration: underline;">False</span>)
    ax.spines[<span style="font-style: italic;">"right"</span>].set_visible(<span style="font-weight: bold; text-decoration: underline;">False</span>)
    ax.spines[<span style="font-style: italic;">"top"</span>].set_visible(<span style="font-weight: bold; text-decoration: underline;">False</span>)
</pre>
</div>

<p>
<a href=""></a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;">fig</span> = plt.figure(figsize=(12, 8))
<span style="font-weight: bold; font-style: italic;">gs</span> = gridspec.GridSpec(2, 1, height_ratios = [.25,1], figure=fig)

<span style="font-weight: bold; font-style: italic;">ax</span> = plt.subplot(gs[0, 0])
add_title(ax, <span style="font-style: italic;">"Candidat(e) des jeunes ?"</span>)

<span style="font-weight: bold; font-style: italic;">ax</span> = plt.subplot(gs[1, 0])
<span style="font-weight: bold; font-style: italic;">pop</span> = <span style="font-weight: bold;">list</span>(population.values())[18:]
ax.bar(
    ages,
    pop,
    width=1.0,
    align=<span style="font-style: italic;">"edge"</span>,
    color=<span style="font-style: italic;">"lightgray"</span>,
    ec=<span style="font-style: italic;">"white"</span>,
)
<span style="font-weight: bold; font-style: italic;">num_votes</span> = participants
ax.bar(
    ages,
    num_votes,
    width=1.0,
    align=<span style="font-style: italic;">"edge"</span>,
    color=<span style="font-style: italic;">"black"</span>,
    ec=<span style="font-style: italic;">"white"</span>,
)
ax.invert_xaxis()
ax.spines[<span style="font-style: italic;">"left"</span>].set_visible(<span style="font-weight: bold; text-decoration: underline;">False</span>)
ax.spines[<span style="font-style: italic;">"right"</span>].set_visible(<span style="font-weight: bold; text-decoration: underline;">False</span>)
ax.spines[<span style="font-style: italic;">"top"</span>].set_visible(<span style="font-weight: bold; text-decoration: underline;">False</span>)

gs.update(hspace=-0.1)
plt.savefig(filename, bbox_inches=<span style="font-style: italic;">"tight"</span>)
filename
</pre>
</div>


<div id="orgd213678" class="figure">
<p><img src="file:///tmp/babel-bVlA5y/figureHYdpyt.png" alt="figureHYdpyt.png" />
</p>
</div>

<p>
Regardons maintenant la différence entre les deux
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;">idx_median</span> = bisect.bisect_left(np.cumsum(pop) / np.<span style="font-weight: bold;">sum</span>(pop), 0.5)
ages[idx_median]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;">idx_median</span> = bisect.bisect_left(np.cumsum(participants) / np.<span style="font-weight: bold;">sum</span>(participants), 0.5)
ages[idx_median]
</pre>
</div>

<div id="outline-container-orgb42b019" class="outline-2">
<h2 id="orgb42b019"><span class="todo TODO">TODO</span> But would that change the election?</h2>
<div class="outline-text-2" id="text-orgb42b019">
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;">fig</span> = plt.figure(figsize=(8, 8))
<span style="font-weight: bold; font-style: italic;">gs</span> = gridspec.GridSpec(<span style="font-weight: bold;">len</span>(intentions)+1, 1, figure=fig)

<span style="font-weight: bold; font-style: italic;">sorted_names</span> = [name <span style="font-weight: bold;">for</span> name, _ <span style="font-weight: bold;">in</span> <span style="font-weight: bold;">sorted</span>(median.items(), key=<span style="font-weight: bold;">lambda</span> item: item[1], reverse=<span style="font-weight: bold; text-decoration: underline;">True</span>)]
<span style="font-weight: bold; font-style: italic;">ax</span> = plt.subplot(gs[0, 0])
add_title(ax, <span style="font-style: italic;">"Candidat(e) des jeunes ?"</span>)
<span style="font-weight: bold;">for</span> i, name <span style="font-weight: bold;">in</span> <span style="font-weight: bold;">enumerate</span>(sorted_names):
    <span style="font-weight: bold; font-style: italic;">ax</span> = plt.subplot(gs[i+1, 0])
    add_pyramide(ax, ages, votes[name], idx_median[name], <span style="font-style: italic;">"lightgray"</span>)
    ax.set_yticks([])
    ax.spines[<span style="font-style: italic;">"bottom"</span>].set_visible(<span style="font-weight: bold; text-decoration: underline;">False</span>)
    <span style="font-weight: bold;">if</span> i != <span style="font-weight: bold;">len</span>(intentions)-1:
       ax.set_xticks([])
    <span style="font-weight: bold;">else</span>:
       ax.set_xticks([18, 30, 40, 50, 60, 70, 100])

gs.update(hspace=0.3)
plt.savefig(filename, bbox_inches=<span style="font-style: italic;">"tight"</span>)
filename
</pre>
</div>


<div id="org2d8c570" class="figure">
<p><img src="file:///tmp/babel-5YZCny/figurewWIjZ7.png" alt="figurewWIjZ7.png" />
</p>
</div>

<p>
Chaque fois que je vois passer des statistiques du vôte par âge, je me représente une population homogène. Alors qu'en fait la pyramide des âges introduit une déformation très importante dans la distribution des votes. Un changement de X% dans la catégorie des plus de 70 ans se traduit par une hausse de X points dans la population globale, alors que de y points si cette modification a lieu chez les 19-25 ans. Il devient alors plus intéressant pour un candidat en campagne d'aller grapiller des points chez les plus agés à cuase de cet effet démultiplicateur.
</p>

<p>
Est-il suffisant que tous les 19-25 ans aillent voter pour équilibrer ce multiplicateur? Je ne pense pas.
</p>
</div>
</div>


<div id="outline-container-org5e9b8a5" class="outline-2">
<h2 id="org5e9b8a5"><span class="todo TODO">TODO</span> Tracer la pyramide des âges des gens en âge de voter</h2>
</div>
<div id="outline-container-org607fb7b" class="outline-2">
<h2 id="org607fb7b"><span class="todo TODO">TODO</span> Tracer la distribution cumulative par âge</h2>
</div>
<div id="outline-container-orgf7e8bc5" class="outline-2">
<h2 id="orgf7e8bc5"><span class="todo TODO">TODO</span> Tracer la pyramide des personnes sûres de voter</h2>
<div class="outline-text-2" id="text-orgf7e8bc5">
<p>
On compare la pyramide des âges de la population en âge de voter avec la pyramide des âges des gens qui sont certains ou presque certains d'aller voter.
</p>

<p>
Il est courant de faire porter la responsabilité du poids électoral des personnes les plus âgées sur l'abstentionnisme des plus jeunes. Nous sommes cependant en droit de nous poser des questions lorsque l'on voit la pyramide des âges.
</p>

<p>
Il est heureusement assez simple de répondre à cette question: il suffit de comparer l'âge médian de l'électeur à l'âge médian dans la population en âge de voter.
</p>
</div>
</div>


<div id="outline-container-org3a73beb" class="outline-2">
<h2 id="org3a73beb"><span class="todo TODO">TODO</span> Superposer la cumlative sûrs de voter avec la cumulative des âges</h2>
</div>
<div id="outline-container-org076a334" class="outline-2">
<h2 id="org076a334"><span class="todo TODO">TODO</span> Tracer la pyramide des votes mélenchon, macron, lepen, jadot, pécresse, zemmour</h2>
</div>

<div id="outline-container-org888c920" class="outline-2">
<h2 id="org888c920">Data</h2>
<div class="outline-text-2" id="text-org888c920">
<ul class="org-ul">
<li><a target='_blank' rel='noopener noreferrer' class='external' href="http://www.commission-des-sondages.fr/notices/files/notices/2022/janvier/9303-p-ipsos-le-monde-fjj-cevipof-janvier-2022.pdf">Sondage Ipsos Janvier 2022</a></li>
<li><a target='_blank' rel='noopener noreferrer' class='external' href="https://www.insee.fr/fr/statistiques/2381472">Pyramide des âges INSEE</a></li>
</ul>
<p>
J
</p>
</div>
</div>

<div id="outline-container-orgcf8483d" class="outline-2">
<h2 id="orgcf8483d">Links to this note</h2>
</div>
</div>
</body>
</html>
