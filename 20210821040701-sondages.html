<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-12-09 Fri 09:49 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sondages</title>
<meta name="author" content="RÃ©mi Louf" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="style.css" /><script data-goatcounter="https://thetypicalset.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Sondages</h1>
<p>
We want to display the latest polls as well as some additional information that should help people undestand the results better. In particular:
</p>
<ul class="org-ul">
<li>Voter turnout (a feature that is often asked);</li>
<li>A reasonable estimation of the error;</li>
<li>The probability to go to 2nd round;</li>
</ul>


<div id="outline-container-org0fd5b73" class="outline-2">
<h2 id="org0fd5b73">Estimate the error</h2>
<div class="outline-text-2" id="text-org0fd5b73">
<p>
We use a Dirichlet-Multinomial model to represent the data generating process. We note \(\vec{p} = (p_1, \dots, p_N)\) the respective probabilities of voting for either of the candidates, \(\vec{\alpha} = (\alpha_1, \dots, \alpha_n)\) the corresponding concentration parameters. The number of votes observed for each candidate is given by:
</p>

<div class="org-src-container">
<pre class="src src-latex"><span style="color: #F0DFAF; font-weight: bold;">\begin</span>{<span style="color: #93E0E3;">align*</span>}
  <span style="color: #F0DFAF; font-weight: bold;">\vec</span>{p} <span style="color: #F0DFAF; font-weight: bold;">\sim</span> <span style="color: #F0DFAF; font-weight: bold;">\operatorname</span>{Dirichlet}(<span style="color: #F0DFAF; font-weight: bold;">\vec</span>{<span style="color: #F0DFAF; font-weight: bold;">\alpha</span>})
  <span style="color: #F0DFAF; font-weight: bold;">\vec</span>{N} <span style="color: #F0DFAF; font-weight: bold;">\sim</span> <span style="color: #F0DFAF; font-weight: bold;">\operatorname</span>{Multinomial}(<span style="color: #F0DFAF; font-weight: bold;">\vec</span>{p}, N_{tot})
<span style="color: #F0DFAF; font-weight: bold;">\end</span>{<span style="color: #93E0E3;">align*</span>}
</pre>
</div>

<p>
It turns out (surprise!) that the Dirichlet distribution is the conjugate prior of the Multinomial distirbution so that the posterior is also a Dirichlet distribution:
</p>

<div class="org-src-container">
<pre class="src src-latex"><span style="color: #F0DFAF; font-weight: bold;">\begin</span>{<span style="color: #93E0E3;">align*</span>}
  <span style="color: #F0DFAF; font-weight: bold;">\vec</span>{p} <span style="color: #F0DFAF; font-weight: bold;">\sim</span> <span style="color: #F0DFAF; font-weight: bold;">\operatorname</span>{Dirichlet}(<span style="color: #F0DFAF; font-weight: bold;">\vec</span>{N} + <span style="color: #F0DFAF; font-weight: bold;">\vec</span>{<span style="color: #F0DFAF; font-weight: bold;">\alpha</span>})
<span style="color: #F0DFAF; font-weight: bold;">\end</span>{<span style="color: #93E0E3;">align*</span>}
</pre>
</div>

<p>
We are interested in displaying the marginals, i.e. \(P(p_i|\vec{N})\). If we call \(\alpha_0 = \sum_i \alpha_i\) we can write
</p>

<div class="org-src-container">
<pre class="src src-latex"><span style="color: #F0DFAF; font-weight: bold;">\begin</span>{<span style="color: #93E0E3;">align*</span>}
  p_i <span style="color: #F0DFAF; font-weight: bold;">\sim</span> <span style="color: #F0DFAF; font-weight: bold;">\operatorname</span>{Beta}(N_i + <span style="color: #F0DFAF; font-weight: bold;">\alpha</span>_i, N_{tot} - N_i + <span style="color: #F0DFAF; font-weight: bold;">\alpha</span>_0 -<span style="color: #F0DFAF; font-weight: bold;">\alpha</span>_i)
<span style="color: #F0DFAF; font-weight: bold;">\end</span>{<span style="color: #93E0E3;">align*</span>}
</pre>
</div>

<p>
From which the HDI can be easily computed using eg <a target='_blank' rel='noopener noreferrer' class='external' href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.beta.html">scipy</a>.
</p>
</div>

<div id="outline-container-orgf959cbd" class="outline-3">
<h3 id="orgf959cbd">Choice of prior</h3>
<div class="outline-text-3" id="text-orgf959cbd">
<p>
Jeffrey prior is \(\alpha_i = 1/2\), <i>but</i> we do have prior information on the different candidates. We know that Arthaud and Poutou, for instance, are more likely to be between 0 and .05. We also know it is unlikely that anyone will be above .4
</p>

<p>
How do we elicit this prior?
</p>
</div>
</div>
</div>


<div id="outline-container-org4b599a0" class="outline-2">
<h2 id="org4b599a0">Estimate the probability that the candidate will go to second tour?</h2>
<div class="outline-text-2" id="text-org4b599a0">
<p>
Take posterior predictive samples for the \(N_i\). Count the number of times the candidate is in the top 10. Run ~100k simulations (&lt; 1s par sondage).
</p>
</div>
</div>

<div id="outline-container-orga232b71" class="outline-2">
<h2 id="orga232b71">Links to this note</h2>
</div>
</div>
</body>
</html>